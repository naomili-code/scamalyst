<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Analyze Messages ‚Äî Scamalyst</title>
    <link rel="stylesheet" href="styles.css">
    <script src="script.js?v=20260217a"></script>
  </head>
  <body>
    <nav class="navbar">
      <div class="nav-container">
        <a href="home.html" class="logo" aria-label="Go to home"><img class="logo-icon" src="scamalyst-logo-icon-removebg-preview.png" alt="Scamalyst logo" /><span class="logo-text">Scamalyst</span></a>
        <ul class="nav-links">
          <li><a href="home.html">Home</a></li>
          <li><a href="analyze.html" class="active">Analyze</a></li>
          <li><a href="practice.html">Practice</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="ethics.html">Ethics</a></li>
          <button class="dark-mode-toggle" id="darkModeToggle" title="Toggle dark mode">üåô</button>
        </ul>
      </div>
    </nav>

    <main class="container analyze-page">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;flex-wrap:wrap;gap:1rem">
        <h2 class="page-header" style="margin:0">Analyze Content</h2>
        <div class="analysis-mode-toggle">
          <button id="modeMessage" class="mode-btn active" data-mode="message" type="button">üìß Message</button>
          <button id="modeWebsite" class="mode-btn" data-mode="website" type="button">üåê Website</button>
        </div>
      </div>

      <!-- Input Panel -->
      <section class="input-panel">
        <div id="messageMode" class="analysis-mode">
          <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
            <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="4" y="8" width="40" height="32" rx="2" stroke="#556cd6" stroke-width="2"/>
              <path d="M4 14H44" stroke="#556cd6" stroke-width="2"/>
              <rect x="8" y="20" width="28" height="12" rx="1" fill="#556cd6" opacity="0.3"/>
            </svg>
            <div>
              <h3 style="margin: 0; color: var(--primary);">üìß Analyze Message</h3>
              <p style="margin: 0.25rem 0 0 0; font-size: 0.85rem; color: var(--muted);">Paste any email, text, or DM</p>
            </div>
          </div>
          <label for="message">Your Message</label>
          <textarea id="message" rows="10" placeholder="Paste an email, text, DM, or social media message here..." aria-describedby="messageHint"></textarea>
          <p id="messageHint" style="font-size:12px;color:#666;margin-top:8px">Tip: This analyzer checks attachment risk, sender-identity mismatch, and invoice/payment scam patterns.</p>
        </div>

        <div id="websiteMode" class="analysis-mode hidden">
          <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
            <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="4" y="6" width="40" height="36" rx="2" stroke="#9b59b6" stroke-width="2"/>
              <path d="M4 18H44" stroke="#9b59b6" stroke-width="2"/>
              <circle cx="12" cy="12" r="1.5" fill="#9b59b6"/>
              <circle cx="20" cy="12" r="1.5" fill="#9b59b6"/>
              <circle cx="28" cy="12" r="1.5" fill="#9b59b6"/>
            </svg>
            <div>
              <h3 style="margin: 0; color: var(--primary);">üåê Analyze Website</h3>
              <p style="margin: 0.25rem 0 0 0; font-size: 0.85rem; color: var(--muted);">Check URL or HTML source</p>
            </div>
          </div>
          <label for="websiteInput">Website URL or HTML</label>
          <textarea id="websiteInput" rows="5" placeholder="Paste a website URL (e.g., https://example.com) or paste the HTML source code..." aria-describedby="websiteHint"></textarea>
          <p id="websiteHint" style="font-size:12px;color:#666;margin-top:8px">Tip: Enter a suspicious website URL or paste its HTML source to analyze for scam indicators.</p>
        </div>

        <div class="input-controls">
          <button id="analyzeBtn" class="btn btn-primary" aria-label="Analyze the message for scams and AI" type="button" onclick="return runAnalysis(event)">Analyze</button>
          <button id="clearBtn" class="btn btn-secondary" type="button">Clear</button>
          <label for="exampleSelect" style="margin-left:auto;display:none" id="exampleLabel">Try an example:</label>
          <select id="exampleSelect" style="display:none">
            <option value="">-- Choose an example --</option>
            <option value="scam">Phishing Scam</option>
            <option value="attachment-lure">Attachment Lure (Malicious File)</option>
            <option value="sender-mismatch">Sender Mismatch (Brand Impersonation)</option>
            <option value="invoice-diversion">Invoice / Payment Diversion</option>
            <option value="ai-chatgpt">AI-Generated (ChatGPT)</option>
            <option value="ai-formal">AI-Generated (Formal)</option>
            <option value="human-casual">Human Writing (Casual)</option>
            <option value="human-professional">Human Writing (Professional)</option>
          </select>
        </div>
      </section>

      <!-- Results Panel -->
      <section id="result" class="result-panel hidden" aria-live="polite" aria-label="Analysis results">
        
        <!-- Score Meters -->
        <div class="score-section">
          <div class="score-meter">
            <p><strong id="scoreLabel">Scam Risk Score</strong></p>
            <div class="meter" aria-label="Scam risk meter">
              <div id="meterFill" class="meter-fill" style="background:linear-gradient(90deg,#2ecc71,#f1c40f,#e74c3c)"></div>
            </div>
            <p id="scamScore" class="score-label">0/10</p>
          </div>

          <div class="score-meter" id="aiMeterContainer">
            <p><strong>AI Likelihood Score</strong></p>
            <div class="meter" aria-label="AI likelihood meter">
              <div id="aiMeterFill" class="meter-fill" style="background:linear-gradient(90deg,#3498db,#9b59b6)"></div>
            </div>
            <p id="aiScore" class="score-label">0%</p>
          </div>
        </div>

        <!-- Red Flags -->
        <div class="red-flags-section">
          <h4>üö© Red Flags Detected</h4>
          <ul id="reasons" role="region" aria-label="Detection reasons" class="red-flags-list"></ul>
        </div>

        <div id="messageInsights" class="message-insights hidden" aria-label="Message insights">
          <div id="scamTypeCard" class="insight-card">
            <h4>üéØ Likely Scam Type</h4>
            <p id="scamTypeLabel" class="insight-main">‚Äî</p>
            <p id="scamTypeDetail" class="insight-sub">Run analysis to classify this message.</p>
          </div>

          <div id="safetyActionsCard" class="insight-card">
            <h4>‚úÖ What To Do Next</h4>
            <ul id="safetyActionsList" class="safety-actions-list"></ul>
          </div>

          <div id="highlightedPhrasesCard" class="insight-card">
            <h4>üñçÔ∏è Highlighted Risk Phrases</h4>
            <div id="flaggedMessagePreview" class="flagged-message-preview"></div>
          </div>
        </div>

      </section>


    </main>

    <footer>
      <p>&copy; 2026 Scamalyst | Cybersecurity Education Project</p>
      <p style="font-size:12px;margin-top:8px">This tool provides guidance, not guarantees. Always verify suspicious messages independently.</p>
    </footer>

    <button class="fab" id="fabBtn" onclick="event.stopPropagation(); toggleChatbot();" title="Ask Scamalyst">‚ùì</button>
    <div class="chatbot-panel" id="chatbotPanel" aria-hidden="true">
      <div class="chatbot-header">
        <div class="chatbot-title">Ask Scamalyst</div>
        <button class="chatbot-close" onclick="closeChatbot()" aria-label="Close chatbot">√ó</button>
      </div>
      <div class="chatbot-body">
        <div class="chatbot-help">
          <button class="chatbot-chip" onclick="sendHelpTopic('scam')">Common Scam Types</button>
          <button class="chatbot-chip" onclick="sendHelpTopic('ai')">AI Detection Tips</button>
          <button class="chatbot-chip" onclick="sendHelpTopic('url')">Website Analysis</button>
        </div>
        <div class="chatbot-messages" id="chatbotMessages"></div>
      </div>
      <form class="chatbot-input" id="chatbotForm" onsubmit="return sendChatMessage(event);">
        <input type="text" id="chatbotInput" placeholder="Ask about scam safety or how Scamalyst works" autocomplete="off" />
        <button type="submit">Send</button>
      </form>
    </div>
  </body>
</html>
